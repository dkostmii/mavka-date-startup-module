взяти списки_операції.поширити
взяти текстові_операції.заповнити
взяти тека.М.підлога

дія методи(Дата)
  дія Дата.привіт()
    друк("Привіт від Лесі!")
  кінець

  дія Дата.форматувати(формат текст або пусто)
    дд   = заповнити(початковий=текст(я.день), символ_пробілу="0", кінцева_довжина=2)
    мм   = заповнити(початковий=текст(я.місяць), символ_пробілу="0", кінцева_довжина=2)
    рррр = заповнити(початковий=текст(я.рік), символ_пробілу="0", кінцева_довжина=4)
    гг   = заповнити(початковий=текст(я.година), символ_пробілу="0", кінцева_довжина=2)
    хх   = заповнити(початковий=текст(я.хвилина), символ_пробілу="0", кінцева_довжина=2)
    сс   = заповнити(початковий=текст(я.секунда), символ_пробілу="0", кінцева_довжина=2)
    ммм  = заповнити(початковий=текст(я.мілісекунда), символ_пробілу="0", кінцева_довжина=3)

    якщо (формат не є пусто)
      якщо (формат не є текст)
        впасти "Очікується, що параметр \"формат\" є текст або пусто"
      кінець
    інакше
      формат = "дд.мм.рррр гг:хх:сс.ммм"
    кінець

    результат = формат
    
    змінні = (
      дд=дд,
      мм=мм,
      рррр=рррр,
      гг=гг,
      хх=хх,
      сс=сс,
      ммм=ммм
    )

    назви_змінних = поширити(змінні.ключі()).сортувати((а, б): б.довжина() - а.довжина())

    перебрати назви_змінних як змінна
      результат = результат.замінити(змінна, змінні.отримати(змінна))
    кінець

    вернути результат
  кінець
кінець

дія статичні_методи(Дата)

  Дата.привіт = дія()
    друк("Привіт від Лесі!")
  кінець

кінець

;; імперативний конструктор структури Дата
дія Дата(
  рік число,
  місяць число,
  день число або пусто,
  година число або пусто,
  хвилина число або пусто,
  секунда число або пусто,
  мілісекунда число або пусто
)
  ;; прихований декларативний конструктор
  структура Дата
    рік число
    місяць число
    день число
    година число
    хвилина число
    секунда число
    мілісекунда число
  кінець

  ;; методи структури
  методи(Дата)

  якщо (рік не є число)
    впасти "Рік повинен бути число"
  кінець

  якщо (місяць не є число)
    впасти "Місяць повинен бути число"
  кінець

  якщо (рік менше 0)
    впасти "Рік повинен бути 0 або більше"
  кінець

  якщо (місяць менше 1 або місяць більше 12)
    впасти "Місяць повинен бути в межах 1 та 12"
  кінець

  ;; усі наступні поля, починаючи з години вимагають
  ;; наявність заданого попереднього поля
  ;; перевірка іде починаючи з мілісекунди
  якщо (мілісекунда не є пусто)
    якщо (мілісекунда не є число)
      впасти "Мілісекунда повинна бути число або пусто"
    кінець

    якщо (секунда є пусто)
      впасти "Очікується, що вказано також секунду, оскільки вказано мілісекунду"
    кінець

    якщо (мілісекунда менше 0 або мілісекунда більше 999)
      впасти "Мілісекунда повинна бути в межах 0 та 999"
    кінець
  інакше
    мілісекунда = 0
  кінець

  якщо (секунда не є пусто)
    якщо (секунда не є число)
      впасти "Секунда повинна бути число або пусто"
    кінець

    якщо (хвилина є пусто)
      впасти "Очікується, що вказано також хвилину, оскільки вказано секунду"
    кінець

    якщо (секунда менше 0 або секунда більше 59)
      впасти "Секунда повинна бути в межах 0 та 59"
    кінець
  інакше
    секунда = 0
  кінець

  якщо (хвилина не є пусто)
    якщо (хвилина не є число)
      впасти "Хвилина повинна бути число або пусто"
    кінець

    якщо (година є пусто)
      впасти "Очікується, що вказано також годину, оскільки вказано хвилину"
    кінець

    якщо (хвилина менше 0 або хвилина більше 59)
      впасти "Хвилина повинна бути в межах 0 та 59"
    кінець
  інакше
    хвилина = 0
  кінець

  якщо (година не є пусто)
    якщо (година не є число)
      впасти "Година повинна бути число або пусто"
    кінець

    якщо (день є пусто)
      впасти "Очікується, що вказано також день, оскільки вказано годину"
    кінець

    якщо (година менше 0 або година більше 23)
      впасти "Година повинна бути в межах 0 та 23"
    кінець
  інакше
    година = 0
  кінець

  якщо (день не є пусто)
    якщо (день не є число)
      впасти "День повинен бути число або пусто"
    кінець

    якщо (день менше 1 або день більше 31)
      впасти "День повинен бути в межах 1 та 31"
    кінець
  інакше
    день = 1
  кінець

  вернути Дата(
    рік=підлога(рік),
    місяць=підлога(місяць),
    день=підлога(день),
    година=підлога(година),
    хвилина=підлога(хвилина),
    секунда=підлога(секунда),
    мілісекунда=підлога(мілісекунда)
  )
кінець

;; статичні методи
;; вони закріплені не за конкретним обʼєктом
;; а за назвою самого конструктора структури
взяти файл "date_methods.js" як date_methods
js date_methods

статичні_методи(Дата)

дати Дата
